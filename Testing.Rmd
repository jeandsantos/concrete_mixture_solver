---
title: "Testing"
author: "Jean Dos Santos"
date: "07/01/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Load Packages

```{r}
# if(!require(shiny)) {install.packages("shiny")} else {require(shiny)}
# if(!require(shinythemes)) {install.packages("shinythemes")} else {require(shinythemes)}
if(!require(GA)) {install.packages("GA")} else {require(GA)}
if(!require(tidyverse)) {install.packages("tidyverse")} else {require(tidyverse)}
if(!require(caret)) {install.packages("caret")} else {require(caret)}
# if(!require(DT)) {install.packages("DT")} else {require(DT)}
# if(!require(nnet)) {install.packages("nnet")} else {require(nnet)}
# if(!require(parallel)) {install.packages("parallel")} else {require(parallel)}

library(tictoc)
```


# Import Data

```{r}
features_ID <- c("Cement", "Slag", "Ash", "Water", "Superplasticizer", "Coarse_Aggregate", "Fine_Aggregate", "Age", "Strength")
features_title <- c("Cement", "Blast Furncace Slag", "Fly Ash", "Water", "Superplasticizer", "Coarse Aggregate", "Fine Aggregate", "Age (days)", "Strength (MPa)")
predictors_ID <- c("Cement", "Slag", "Ash", "Water", "Superplasticizer", "Coarse_Aggregate", "Fine_Aggregate")
age_selected <- 28 # Days of aging

# Import model
if(!exists("model_strength")) {model_strength <- base::readRDS("Models/avNNet_model.rds")}

# Import Functions
eval_function_with_limits <- base::source("helpers/eval_function_with_limits.R")
GA_summary_plot <- base::source("helpers/GA_summary_plot.R")
message(Sys.time(),": Supporting functions imported")
```

```{r}
limits_GA <- data_frame(
       Cement_min = Cement_range[1],
       Cement_max = Cement_range[2],
       Ash_min = Ash_range[1],
       Ash_max = Ash_range[2],
       Coarse_Aggregate_min = Coarse_Aggregate_range[1],
       Coarse_Aggregate_max = Coarse_Aggregate_range[2],
       Fine_Aggregate_min = Fine_Aggregate_range[1],
       Fine_Aggregate_max = Fine_Aggregate_range[2],
       Slag_min = Slag_range[1],
       Slag_max = Slag_range[2],
       Superplasticizer_min = Superplasticizer_range[1],
       Superplasticizer_max = Superplasticizer_range[2],
       Water_min = Water_range[1],
       Water_max = Water_range[2],
       )

min_limits_GA <- data_frame(
       Cement = Cement_range[1],
       Ash = Ash_range[1],
       Coarse_Aggregate = Coarse_Aggregate_range[1],
       Fine_Aggregate = Fine_Aggregate_range[1],
       Slag = Slag_range[1],
       Superplasticizer = Superplasticizer_range[1],
       Water = Water_range[1]
       )

max_limits_GA <- data_frame(
       Cement = Cement_range[2],
       Ash = Ash_range[2],
       Coarse_Aggregate = Coarse_Aggregate_range[2],
       Fine_Aggregate = Fine_Aggregate_range[2],
       Slag = Slag_range[2],
       Superplasticizer = Superplasticizer_range[2],
       Water = Water_range[2]
       )

mid_values_GA <- data_frame(
       Cement = Cement_range[3],
       Ash = Ash_range[3],
       Coarse_Aggregate = Coarse_Aggregate_range[3],
       Fine_Aggregate = Fine_Aggregate_range[3],
       Slag = Slag_range[3],
       Superplasticizer = Superplasticizer_range[3],
       Water = Water_range[3]
       )

limits_GA
min_limits_GA
max_limits_GA
mid_values_GA
```

```{r}
Cement = range$mid[range$Parameter == "Cement"]
Ash = range$mid[range$Parameter == "Ash"]
Coarse_Aggregate = range$mid[range$Parameter == "Coarse_Aggregate"]
Fine_Aggregate = range$mid[range$Parameter == "Fine_Aggregate"]
Slag = range$mid[range$Parameter == "Slag"]
Superplasticizer = range$mid[range$Parameter == "Superplasticizer"]
Water = range$mid[range$Parameter == "Water"]

input_data <- tibble(
  Cement = Cement,
  Ash = Ash,
  Coarse_Aggregate = Coarse_Aggregate,
  Fine_Aggregate = Fine_Aggregate,
  Slag = Slag,
  Superplasticizer = Superplasticizer,
  Water = Water,
  Age = 28
)
```

# `eval_function`




```{r}
x <- tibble(a = 23, 
            b = 21, 
            c = 32,
            .name_repair = ~ c("a1", "a2", "a3")
            )

x_react <- reactive({x})

x_iso <- isolate({ x })

write.csv(x, file = "x.csv")
# write.csv(x_react, file = "x_react.csv")
write.csv(x_iso, file = "x_iso.csv")
```

























































































